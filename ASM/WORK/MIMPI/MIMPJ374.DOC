　＝＝　Ｄｙｎａ　ＭＩＭＰＩ　Ｖｅｒ３．７（Dyna version 1.4）　＝＝

　ＰＣ９８でお馴染みのＭＩＭＰＩを J-3100 DynaBook に移植してみました。
　画面表示等で若干の制約はありますがＩＢＭ−ＰＣ及びその互換機での動作報告も
　頂いております。
　詳しい機能については申し訳ありませんが９８版MIMPIのＤＯＣをご覧ください。

　［Dyna version 1.1 からの変更点］

　・９８版等に報告された不具合部分の修正。
　　（９８版の MIMPIV3 Ver3.6g 相当を移植しています。）

　・レコンポーザ２．５データへ対応。

　・Ｂａｌｌａｄｅ３データへの対応。
　　ただし、Ｂａｌｌａｄｅ３は入手して日が浅いため十分なデータの分析を行なっ
　　ていません。本家の演奏と異なる部分があるかもしれません。
　　バラード３はＳＣ−７に対する若干の設定を行ないますが、本バージョンでは
　　この設定は行なっていません。

　・４８６／６６ＭＨｚのＤＯＳ／ＶマシンでMIDIatorを使って演奏させた場合ハング
　　する報告があり、一応対策した。いろいろなマシンでの動作確認をした訳ではない
　　ので不具合が生じるようであれば連絡してください。
　　この件ではＨＡＪＩさんにお手数おかけしました。ありがとうございました。

　・ＢＥＥＰ演奏時、一部の音程が違っていたのを修正。

　・ＰＣ／ＡＴ互換機のＶＧＡモード（640×480ドット）に仮対応


　［Dyna version 1.3 からの変更点］

　９８版ＭＩＭＰＩのＶｅｒ３．７ｂ相当を移植しました。

　・Ballade3の演奏部分を見直し改良しました。

　・割込み処理を少し変更しました。また標準MIDI Fileの演奏処理方法も少し変更
　　しました。これにより遅い機種でも従来より安定した演奏ができるようになり
　　ました。

　・/GS や /SC が指定されていた場合、従来は GS Reset の後に GM ON を出力して
　　いましたが、GM ON を先に出力するようにしました。

　・/TF 及び /$ オプションを追加しました。

　・Super MPU (S-MPU) が使われている場合ネイティブモードで動作するようにした
　　つもり(^^;)
　　S-MPUが装備され、/In オプションが指定されない時に限り、S-MPUを自動判別し
　　ネイティブモードで動作させます。ただし実機がないので未確認です。
　　S-MPUが持っている豊富な機能のうちの極く一部しか利用していません。
　　MIMPIの動作だけでS-MPUを評価することは避けてください。
　　ネイティブモードで動作している時は ｢I/F = S-MPU｣ が演奏画面に表示されます。
　　A/B のポートには同じものが出力され、MIDI THRU ON の状態（MIDI INの信号が
　　そのままOUTに出る）で動作します。

　・GSDファイルで２つ以上のパートがリズムとして指定されている場合に演奏画面の
　　表示にも反映させるようにしました。
　　ただし GSDファイルがある時だけでデータ中にエクスクルーシブで埋め込まれて
　　いる場合には１０Ｃｈだけをリズムとして表示します。

  ・ポーズＯＮの時にHOME/CLRキーを押すと曲の先頭に戻り演奏を始める機能を追加
　　しました。

　・ＶＧＡ(640 x 480)のモードで正常に表示できない機種が多かったため表示ルーチン
　　を改良しました。


［利用上の注意］

　　今回のバージョンは実機（J-3100DynaBook及びDOS/Vマシン）が無い状態で作成さ
　れています。従って細かい動作確認はほとんど行なわれていません。
　特に９８用のＷＲＤファイルを表示させた場合、異常動作があるかもしれません。
　うまく演奏できない場合は .WRD のファイルを削除して実行させてみてください。


［使用方法］

　MIMPIJ3 </sw> song_file

　で各種ＭＩＤＩデータを演奏できます。 /sw は必要に応じて指定します。
　演奏可能なデータは次の通りです。（[ ]内は曲データファイルの拡張子）

　標準MIDI File Format0,1   [.MID , .STD ,  .MFF　等]
　ミュージ君／郎／郎２　　　[.SNG]
　バラード／バラード２　　　[.SNG]
　バラード３　　　　　　　　[.SNG]
　ＲＣＭ Ver1               [.MCP]
　ＲＣＭ Ver2（Ver2.3a含む) [.RCP]
　レコンポーザ２．５　　　  [.RCP]
　ﾏｲｸﾛﾐｭｰｼﾞｼｬﾝVer1　　　　　[.MMC]
　ﾏｲｸﾛﾐｭｰｼﾞｼｬﾝVer2.0/2.1　　[.MM2]
  Hello!Music!              [.MM2]    /HM を指定すること
  芸達者　　　　　　　　　　[.SEQ]
　ＥＳＥＱ　　　　　　　　　[不定]

　その他完全対応ではありませんが EXPERT（拡張子 .SNG）のデータも演奏可能です。


　MIMPIJ3 は起動時のｵﾌﾟｼｮﾝｽｲｯﾁで、いろいろな動作を指定することができます。
　MIMPIJ3 </sw> song_file  の形で使用します。
　ｵﾌﾟｼｮﾝｽｲｯﾁ は複数の指定が可能です。
　起動スイッチは予め、環境変数 MIMPI_SW に定義しておくことができます。
　例えばＩ／ＦにRS-232Cを常に使う場合は

    SET MIMPI_SW=/I3

　のように定義しておくと、起動の都度指定する必要がなく便利です。
　MIMPI_SW に定義されたものと同じ機能指定が起動時に指定された場合は起動時
　の指定が優先されます。


　［オプションスイッチ一覧］

　　　/#ccc･･･ccc     送信MIDI Chを変更します。

　　　/$              標準MIDI File演奏時にRolandｴｸｽｸﾙｰｼﾌﾞのDevice IDを１７
　　　　　　　　　　　に付けなおします。

      /BW:nnnn        ソフトのよるボーレートの調整値の指定（nnnn=20〜1023）

　　　/CMD 　　　　　 CM-64のLA/PCMパートをOFFにします。

　　　/CK             MTR画面に発音している音の数を表示します。

　　　/DR:drm_file　　ドラムアサインファイルを読み込みます。

　　　/DOM　　　　　　表示音色名を YAMAHA TG-100 のDOMモードの音色名で表示
　　　　　　　　　　　します。また TG-100 をDOMモードで初期化します。

　　　/E　　　　　　　演奏終了時、キー入力待ちにしないで終了します。

      /EGA            640 X 200 のグラフィックモードで実行します。 

　　　/G　　　　　　　グラフィック及びテキスト画面の初期化をしません。

　　　/GS　　　　　　 音色表示等をＧＳ規格に対応させます。

　　　/GSD 　　　　　 GS音源部分をOFFにします。

　　　/HM　　　　　　 MM2データをHello Musicのデータとして演奏します。

　　　/In　　　　　　 使用する I/F を指定します。

      /IA:address     MPU(または互換Ｉ／Ｆ）のアドレスをデフォルトから変更して
　　　　　　　　　　　いる場合にそのアドレスを設定します。
　　　　　　　　　　　例） /IA:220

　　　/KTn 　　　　　 演奏時のキーシフトを指定します。

　　　/Ln　　　　　　 繰返しの回数を設定します。

      /LA             ミュージ郎のPCMパートをLAに変換して演奏します。

  　　/Mttt･･ttt      指定したTrackをミュートして演奏します。

　　　/MT 　　　　　　ミュージ郎やバラードのデータで使用しない音源部をOFFに
　　　　　　　　　　　するエクスクルーシブを送信しなくします。

　　　/MVn　　　　　　ﾏｽﾀｰﾎﾞﾘｭｰﾑをｺﾝﾄﾛｰﾙﾁｪﾝｼﾞに変換して出力します。

　　　/N　　　　　　　RCMデータ演奏時、音色データの送信を禁止します。

　　　/PA　　　　　　 演奏開始の時ポーズ状態で待機します。

　　　/P:pho_file　　 PHOファイル名を指定します。
　　　　　　　　　　　/P: のみでPHOファイルの表示を禁止します。

      /PT:pcm_tone    バラード２のＰＣＭユーザ音色ファイルを指定します。

      /R              起動/終了時 MT-32/CM-64/GS音源 のリセットを禁止します。

      /RLn            MT-32/CM-64 のリバーブレベルを指定します。

      /RMn            MT-32/CM-64 のリバーブモードを指定します。

      /RTn            MT-32/CM-64 のリバーブタイムを指定します。

　　　/SC　　　　　　 SC-55やCM-300でCM-64のシミュレーションをします。

　　　/SC2 　　　　　 CM-500でCM-64のシミュレーションをします。

　　　/TC             標準MIDI FILE演奏時にTrack番号でMIDI Chを付け直します。

      /TF　　　　　　 曲データファイルと同名の .CM6 または .GSD ファイルがある
　　　　　　　　　　  場合はその内容を送信します。
　　　　　　　　　　　(.CM6 .GSD はレコンポーザ９８が作る音色ファイルです。）

　　　/Tn             演奏テンポの微調整を行ないます。

　　　/T:def_file 　　初期設定や音色変換を行なう定義ファイルを指定します。

　　　/U　　　　　　　ミュージ郎データのＰＣＭパートを 11〜16Chに出力します。

      /VGA            640 X 480 のグラフィックモードで実行します。 

　　　/W:wrd_file　　 wrdファイル名を指定します。
　　　　　　　　　　　/W: のみでwrdファイルの実行を禁止します。

　　　/Zbar<,tempo> 　指定小節まで早送りします。

　　（注）同じ機能のｓｗが２つ以上指定された場合は最後の指定が有効となります。
　　　　　［例］　/I1/I2/I3 と指定された時は /I3 が有効となります。


　［／Ｉｎオプション］


　　／Ｉ０　　　　MPU-IMC,MPU-IPC 及び相当品の指定。
　　　　　　　　　I/Oアドレスは 330H がデフォルトですが、これ以外に変更してい
　　　　　　　　　る場合には /IA: オプションでアドレスを指定してください。
                  ULTEC の MIDI STATION もこのモードで動作報告を頂いています。
　　　　　　　　　Super-MPU が装備されている場合は UARTモードで動作させます。

　　／Ｉ１　      RS-232CのＴＸＤから 31.25KbpsのMIDI信号を出力します。
　　　　　　　　　EMU-232C 等の９８用のI/Fを９ピン→２５ピンの変換コネクターを
                  使って使用してください。
　　　　　　　　　TXD から出力してるところがミソです。(^^)
　　　　　　　　　タイミング調整が必要です。（後述）
　　　　　　　　　SC-55mk2 の HOST端子を RS232C-1 にしても使用できます。
　　　　　　　　　COM2ポートを使う場合は /I12 として下さい。

　　／Ｉ２　　　　KEY ELECTORONICS社製の MIDIator の指定。
　　　　　　　　　COM2ポートを使う場合は /I22 として下さい。

　　／Ｉ３　　　　RS-232C から 38.4Kbps で出力します。
　　　　　　　　　SC-55mk2 の HOST端子を RS-232C-2 にして使用します。
　　　　　　　　　/I1 より安定して使えるので該当の音源をお持ちの方は /I3 を指
                  定してください。
　　　　　　　　　COM2ポートを使う場合は /I32 として下さい。

　　／Ｉ８　　　　９８版ではお馴染みＢＥＥＰです。
                  取り敢えず本体だけで音が出るのがミソです。(^^)
　　　　　　　　　ただし、パート数の多いデータではうまく演奏できない場合もあり
                  ます。デフォルトでは５重和音まで時分割で発音させます。
　　　　　　　　　（/I81〜/I88 で同時発音数を変えられます。）


　ｅｘ） MIMPIJ3 /I8 SAMPLE　 ＢＥＥＰによりSAMPLEと言う曲データを演奏します。


　DynaMIMPI では起動時に MPU → MIDIator の順でＩ／Ｆが接続されているかを判別
　し、接続されているＩ／Ｆを自動的に使用します。いずれも接続されていない場合は
　ソフトウェアボーレート方式（/I1 と同等）になります。
　これ以外を使用したりＣＯＭ２ポートを使用する場合は /In で指定してください。


　［／ＢＷ：オプション］

　　/I1 では高価なＩ／Ｆを必要としない替りにソフトでタイミングをとっているので
　　調整が必要です。　/BW:nnnn で指定します。
　　J-3100GS 及び J-3100SS の２機種に限り最適値を自動設定します。
    J-3100GS の場合は /BW:158 、J-3100SS の場合は /BW:98 に設定されます。
　　なお、J-3100SSではクロックが５ＭＨｚの場合でも自動設定されます。
　　それ以外の機種の場合は、最適値を調整してください。
　　遅い機種なら小さく、速い機種なら大きくします。
　　かなりクリチカルなので±１ずつ増減してみてください。
　　あまり速度の遅い機種では実用的に使えない可能性があります。
　　オシロスコープが利用できる場合は、次のようにして調整してください。
　　適当な曲データを用意して、/PA /BW:nnn を指定して立上げてください。
　　（nnn は調整する数値）
　　起動後ポーズ状態になり、MIDI CLOCK だけを出力します。
　　この時 TXD の波形を観測します。
　　正のパルス巾を１２８マイクロｓｅｃになるように nnn を調整してください。
　　GS音源 SC-55 を使ってこのタイミング調整を行なっている時、音源の動作が
　　おかしくなってしまうことを何度か経験しました。
　　この場合は音源の電源アダプターを抜くと回復します。

　（注）
　　この方式をサポートしているのは Dyna MIMPI とＨａｊｉ氏作のＳＲＥＣだけ
　　です。Dyna MIMPI と SREC の調整値は互換性があります。
　　ＳＲＥＣにはこのタイミング調整を簡単に行なうための機能があります。
　　タイミング調整にはＳＲＥＣをお勧めします。
　　三鈴エリー製の MIDIｱﾀﾞﾌﾟﾀ EMU-232C 等も９ﾋﾟﾝ→２５ﾋﾟﾝの変換コネクター
　　を用いることによって使うことができます。
　　ＣＰＵが８０４８６で大きなＣＰＵキャッシュを積んでいる場合は不安定にな
　　る場合があります。そのような高級なマシンではできるだけMIDI I/Fを用意して
　　利用しましょう。(^^)


　［キー操作］

　　基本的には９８版と同じです。
　　ちなみにフルキーの１〜０が９８テンキーに対応させてあります。
　　ALT キーが９８のGRPHキーに対応してあります。
　　但し、９８のテンキーとファンクションキーを使う操作は中途半端です。
　　動くやつと動かないのがあります。(^^;)
　　演奏の中断は CTRL-C か CTRL-Break です。中断後は SPACE で終了します。
　　ALT+SysReq で一時的にＤＯＳに戻ります。EXIT で再びMIMPIに戻ります。
　　ただし、タイマー割込みをMIMPIが占有しているためいろいろ不都合が起こること
　　も考えられます。使用にあたっては十分注意してください。


　［ＷＲＤファイルの実行について］

　　文字だけで構成されるＷＲＤファイルは一応実行できます。
　　ただし、エスケープシーケンスの違いにより正しく実行できない場合もあります。
　　@EXEC() で９８依存のプログラムを呼出している場合はダメです。
　　何が起こっても知りません。(^^;)
　　ベタファイルの読み込み（ＰＨＯファイル）は一応１プレーンだけ表示できるよう
　　にしてあります。（９８のＢプレーン相当の部分を表示）


　［ＩＢＭ−ＰＣ及びその互換機での動作］

　　基本的には DynaBook用として作成したものですがＩＢＭ−ＰＣ及びその互換機で
　　の動作報告もいくつか頂いています。
　　簡単に使用できるスクリーンモードをチェックして最適と思われるモードで実行
　　します。（ただし白黒または２色モードになります。）
　　この自動判別がうまくいかない場合は /VGA または /EGA を起動時に指定してく
　　ださい。

　　/VGA  ６４０×４８０ドットのモードで実行します。
　　/EGA  ６４０×２００ドットのモードで実行します。

　　（640×200は CGA なのですが、最初に思い違いをしてオプション名が/EGAになって
　　　しまっています。(^^;)）
　　なお、ANSI.SYS は必ず組込んで使用してください。
　　どうしても表示がうまくできない場合は /G を指定してください。
　　/G を付けて起動させると画面表示をまったく行なわず演奏だけ行ないます。
　　ＷＲＤファイル付きのデータでエスケープシーケンスによって文字色を変えている
　　場合も /G を指定してください。起動時のスクリーンモードのまま実行しますので
　　カラー表示が可能な状態であれば色が出るはずです。ただし、ＰＣ９８０１で作成
　　されたデータの場合エスケープシーケンスに互換性がない部分がありますので正常
　　に表示できない場合もあります。

　［ＶＧＡモードでの動作について］

　　ＶＧＡモードの表示に関しては実機が無いので、まったくの手探りでコーディング
　　しています。（どんな表示になるか私は見ていません。(^^;)）
　　HUCOM-NET のＨＡＪＩさんに動作チェックでお世話になりました。
　　なお使用しているビデオカードの種類によっては正常な表示ができないこともある
　　かもしれません。
　　完全な状態にするのは将来ＤＯＳ／Ｖ機が使えるようになるまでお待ちください。
　　（永久にそうならないかもしれませんが(^^;;)）

　　ＩＢＭ−ＰＣは私自身が持っていないため詳しいことが判りません。
　　いろいろ御指導頂ければ幸いです。

　［その他］

　　演奏できるデータフォーマットやＤＥＦファイル機能は９８版と同等です。
　　９８版の Ver 3.7b 相当を移植しています。
　　MIDIator の動作は J3100SS でしか確認していません。より高速のマシンでは
　　うまく動作しない可能性もあります。いろいろな機種での動作報告をお待ちして
　　います。
　　バージョンアップ等のサポートは
　　マスターネット「コンピュータで音楽を」【MIMPI館】にて行ないます。


　・転載について

　　営利目的でない限り転載は許可します。
　　ただし、DynaBook以外では問題点があるかもしれないことをご承知ください。


　・謝　辞

　　マスターネット、Data Statin WAI･WAI、HUCOM-NET の各ネットの皆さんには
　　たくさんの動作レポート等でお世話にになりました。
　　起動時に表示されるタイトルロゴはＰＣ−ＶＡＮの∞☆（倉）さんが文豪版用
　　に作成されたものを一部流用させて頂きました。
　　演奏画面の「ＭＩＭＰＩ」のロゴはマスターネットのＮＯＲＩさんに作って
　　頂きました。改めてお礼申上げます。

　　月刊ＡＳＣＩＩ編集部の皆様には動作確認のためお世話になりました。


　姉妹品の「文豪ｍｉｎｉ７」対応のＭＩＭＰＩも公開されています。(^^)
　ＭＩＭＰＩ専用のファイル選択ツール「ＭＵ」（作者：Otoyan氏）もJ-3100に
　移植されました。ぜひ御利用ください。


　　　　　　　　　　　　　　　　　　　マスターネット　ａａｄ１０２［斎　藤］
                                       DS-WAI･WAI     DS00010
                                       HUCOM-NET      HU0018
